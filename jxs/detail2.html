<!DOCTYPE html>
<html>
<head>
    <title>网上讲习所</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- head 中 -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/weui/1.1.2/style/weui.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/jquery-weui/1.2.0/css/jquery-weui.min.css">

    <link href="../css/main.css" rel="stylesheet" />

</head>
<body>
    <div class="nav">
        <span onclick="history.go(-1)">
            <img src="../img/arrow-left.png" />
        </span>
        <span></span>
        <span id="btn-nav">导航</span>
    </div>
    <div class="weui-skin_android" id="androidActionsheet" style="display:none">
        <div class="weui-mask" style="visibility:visible; opacity:0.5"></div>
        <div class="weui-actionsheet">
            <div class="weui-actionsheet__menu">
                <div class="weui-actionsheet__cell" onclick="location.href='index.html'">网上讲习所</div>
                <div class="weui-actionsheet__cell" onclick="location.href='map.html'">党建大数据</div>

                <div class="weui-actionsheet__cell" onclick="location.href='center.html'">云学习中心</div>
                <div class="weui-actionsheet__cell" onclick="location.href='jianguan.html'">驻村云监管</div>

                <div class="weui-actionsheet__cell" onclick="location.href='user.html'">个人信息</div>
            </div>
        </div>
    </div>

    <div class="panel detail">

        <div class="panel-body">
            <div class="card-alert">
                <div class="alert-title" id="title">强化思想入党，掌握党，基本知识</div>
                <div class="alert-body">
                    <div class="item">
                        <img src="../img/kecheng3.png" />
                        <span>来源：<span id="source"></span></span>
                    </div>
                    <div class="item">
                        <img src="../img/kecheng31.png" />
                        <span>作者：<span id="author"></span></span>
                    </div>

                    <div class="item">
                        <img src="../img/kecheng31.png" />
                        <span>学分：<span id="period"></span></span>
                    </div>
                    <div class="item">
                        <img src="../img/kecheng33.png" />
                        <span>发布时间：<span id="pubtime"></span></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel-body">
            <div style="display:none" id="encode-content"></div>
            <div class="content">

            </div>
        </div>

    </div>

    <div class="panel detail comments">

        <div class="panel-body">
            <div class="card-alert">
                <div class="alert-title">课后练习题</div>

            </div>
        </div>

        <div class="weui-panel weui-panel_access test">
            
         
            <div class="weui-panel__hd">一、单选题</div>
            <div id="choseList">
                <div class="weui-panel__bd">
                    <span href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">
                        <div class="weui-media-box__bd">
                          
                            <p class="weui-media-box__desc">{{no}}. {{question}}:   </p>

                            <div class="weui-cells weui-cells_radio">
                                <label class="weui-cell weui-check__label" for="x1{{id}}">
                                    <div class="weui-cell__bd">
                                        <p>A. {{answerA}}</p>
                                    </div>
                                    <div class="weui-cell__ft">
                                        <input type="radio" name="radio_{{id}}" class="weui-check" value="a" id="x1{{id}}">
                                        <span class="weui-icon-checked"></span>
                                    </div>
                                </label>
                                <label class="weui-cell weui-check__label" for="x12{{id}}">

                                    <div class="weui-cell__bd">
                                        <p>B. {{answerB}}</p>
                                    </div>
                                    <div class="weui-cell__ft">
                                        <input type="radio" name="radio_{{id}}" class="weui-check" value="b" id="x12{{id}}">
                                        <span class="weui-icon-checked"></span>
                                    </div>
                                </label>
                                <label class="weui-cell weui-check__label" for="x13{{id}}">

                                    <div class="weui-cell__bd">
                                        <p>C. {{answerC}}</p>
                                    </div>
                                    <div class="weui-cell__ft">
                                        <input type="radio" name="radio_{{id}}" class="weui-check" value="c" id="x13{{id}}">
                                        <span class="weui-icon-checked"></span>
                                    </div>
                                </label>
                                <label class="weui-cell weui-check__label" for="x14{{id}}">

                                    <div class="weui-cell__bd">
                                        <p>D. {{answerD}}</p>
                                    </div>
                                    <div class="weui-cell__ft">
                                        <input type="radio" name="radio_{{id}}" class="weui-check" value="d" id="x14{{id}}">
                                        <span class="weui-icon-checked"></span>
                                    </div>
                                </label>

                            </div>

                        </div>
                    </span>


                </div>

            </div>


        </div>

        <!--<div class="weui-panel weui-panel_access test">
            <div class="weui-panel__hd">二、多选题</div>

            <div class="weui-panel__bd">
                <span href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">
                    <div class="weui-media-box__bd">

                        <p class="weui-media-box__desc">1. 受到留党察看处分的党员，恢复党员权利后_____内，不得在党内担任和向党外组织推荐担任与其原任职务相当或者高于其原任职务的职务。</p>

                        <div class="weui-cells weui-cells_checkbox">
                            <label class="weui-cell weui-check__label" for="s111">
                                <div class="weui-cell__hd">
                                    <input type="checkbox" class="weui-check" name="checkbox1" id="s111">
                                    <i class="weui-icon-checked"></i>
                                </div>
                                <div class="weui-cell__bd">
                                    <p>A. 半年·· </p>
                                </div>
                            </label>
                            <label class="weui-cell weui-check__label" for="s121">
                                <div class="weui-cell__hd">
                                    <input type="checkbox" name="checkbox1" class="weui-check" checked="checked" id="s121">
                                    <i class="weui-icon-checked"></i>
                                </div>
                                <div class="weui-cell__bd">
                                    <p>B. 一年·· </p>
                                </div>
                            </label>
                            <label class="weui-cell weui-check__label" for="s122">
                                <div class="weui-cell__hd">
                                    <input type="checkbox" name="checkbox1" class="weui-check" checked="checked" id="s122">
                                    <i class="weui-icon-checked"></i>
                                </div>
                                <div class="weui-cell__bd">
                                    <p>C. 两年·      </p>
                                </div>
                            </label>
                            <label class="weui-cell weui-check__label" for="s123">
                                <div class="weui-cell__hd">
                                    <input type="checkbox" name="checkbox1" class="weui-check" id="s123">
                                    <i class="weui-icon-checked"></i>
                                </div>
                                <div class="weui-cell__bd">
                                    <p>D. 三年</p>
                                </div>
                            </label>
                        </div>

                    </div>
                </span>
            </div>


        </div>-->

        <div class="weui-panel weui-panel_access test">
            <div class="weui-panel__hd">二、判断题</div>
            <div id="judgeList">
                <div class="weui-panel__bd">
                    <span href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">
                        <div class="weui-media-box__bd">
                            <p class="weui-media-box__desc">1. 下列___项是最根本的党内法规，是管党治党的总规矩:</p>
                            <div class="weui-cells weui-cells_radio">
                                <label class="weui-cell weui-check__label" for="y{{id}}">
                                    <div class="weui-cell__bd">
                                        <p>A. 对</p>
                                    </div>
                                    <div class="weui-cell__ft">
                                        <input type="radio" class="weui-check" name="radio_{{id}}" value="v" id="y{{id}}">
                                        <span class="weui-icon-checked"></span>
                                    </div>
                                </label>
                                <label class="weui-cell weui-check__label" for="y2{{id}}">

                                    <div class="weui-cell__bd">
                                        <p>B. 错</p>
                                    </div>
                                    <div class="weui-cell__ft">
                                        <input type="radio" name="radio_{{id}}" class="weui-check" value="x" id="y2{{id}}">
                                        <span class="weui-icon-checked"></span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </span>
                </div>
            </div>
        </div>

        <div class="weui-panel__bd" style="padding:20px;">
            <button id="btn-test" class="weui-btn weui-btn_default">提交练习</button>
        </div>


        <br /><br />
    </div>


    <div class="panel detail comments">

        <div class="panel-body">
            <div class="card-alert">
                <div class="alert-title">学习心得</div>
                <div class="alert-body">
                    <div class="item">
                        <div class="user"><div><img src="../img/p111.jpg" id="avatar" />&nbsp; <span id="nickname">王小李</span></div>   <span id="time"></span></div>
                        <p>
                            <textarea id="xd-content" maxlength="200" rows="5" placeholder="请输入学习心得"></textarea>
                            <button id="btn-comment" class="weui-btn weui-btn_default">提交学习心得</button>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div id="aqList">

        </div>

        <!--<div class="panel-body">
            <div class="card-alert">
                <div class="alert-body">
                    <div class="item">
                        <div class="user"><div><img src="../img/p111.jpg" />&nbsp; 王小李</div>   <span>2018-05-06 15:35</span></div>
                        <p>本期内容：强化思想入党，掌握党，基本知识，提高履行党员义务的素质与能力。</p>
                    </div>
                </div>
            </div>
        </div>-->


    </div>

    <!--<a href="javacsript:void(0)" id="goToTest" class="weui-btn weui-btn_primary btn-bottom-fixed">去考试</a>-->
    <!-- body 最后 -->
    <script src="https://cdn.bootcss.com/jquery/1.11.0/jquery.min.js" type='text/javascript' charset='utf-8'></script>
    <script src="https://cdn.bootcss.com/jquery-weui/1.2.0/js/jquery-weui.min.js" type='text/javascript' charset='utf-8'></script>
    <script src="https://g.alicdn.com/dingding/open-develop/1.9.0/dingtalk.js" type='text/javascript' charset='utf-8'></script>
    <script src="../scripts/main.js"></script>
    <!-- Initialize Swiper -->
    <script>

        var userInfo = {};
        var articleTitle = "文章标题";
        var url = window.location.href;
        var id = GetQueryString("id");

        var aritcleId = id;

        function setUserInfo(info) {
            userInfo = info;
            // alert(JSON.stringify(userInfo));
            if (info.avatar != "") {
                $("#avatar").attr("src", info.avatar);
            }
            $("#nickname").text(info.nickName);

            $.ajax({
                url: "https://dangjain.ishoubei.com/study",
                method: "Post",
                data: {
                    user_id: userInfo.emplId,
                    article_id: id
                },
                success: function (re) {
                    // alert(JSON.stringify(re));
                }
            });

        }

        var cHtml = '<div class="weui-panel__bd">' +
                    '<span href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">' +
                     '   <div class="weui-media-box__bd"><img id="img_{{id}}" src="../img/right.png" class="right" style="display:none" />' +
                      '      <p class="weui-media-box__desc" answer="{{answer}}">{{no}}. {{question}}:   </p>' +
                       '     <div class="weui-cells weui-cells_radio">' +
                        '        <label class="weui-cell weui-check__label" for="x1{{id}}">' +
                         '           <div class="weui-cell__bd">' +
                          '              <p>A. {{answerA}}</p>' +
                           '         </div>' +
                            '        <div class="weui-cell__ft">' +
                             '           <input type="radio" name="radio_{{id}}" class="weui-check" value="A" id="x1{{id}}">' +
                              '          <span class="weui-icon-checked"></span>' +
                               '     </div>' +
                                '</label>' +
                               ' <label class="weui-cell weui-check__label" for="x12{{id}}">' +
                                '    <div class="weui-cell__bd">' +
                                 '       <p>B. {{answerB}}</p>' +
                                  '  </div>' +
                                   ' <div class="weui-cell__ft">' +
                                '        <input type="radio" name="radio_{{id}}" class="weui-check" value="B" id="x12{{id}}">' +
                                 '       <span class="weui-icon-checked"></span>' +
                                  '  </div>' +
                       '         </label>' +
                        '        <label class="weui-cell weui-check__label" for="x13{{id}}">' +
                         '           <div class="weui-cell__bd">' +
                          '              <p>C. {{answerC}}</p>' +
                           '         </div>' +
                            '        <div class="weui-cell__ft">' +
                             '           <input type="radio" name="radio_{{id}}" class="weui-check"  value="C" id="x13{{id}}">' +
                              '          <span class="weui-icon-checked"></span>' +
                               '     </div>' +
                 '               </label>' +
                  '              <label class="weui-cell weui-check__label" for="x14{{id}}">' +
                   '                 <div class="weui-cell__bd">' +
                    '                    <p>D. {{answerD}}</p>' +
                     '               </div>' +
                      '              <div class="weui-cell__ft">' +
                       '                 <input type="radio" name="radio_{{id}}" class="weui-check" value="D" id="x14{{id}}">' +
                        '                <span class="weui-icon-checked"></span>' +
                         '           </div>' +
                          '      </label>' +
                           ' </div>' +
                  '      </div>' +
                   ' </span>' +
               ' </div>';

        var jHtml = '<div class="weui-panel__bd">' +
                     '<span href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">' +
                         '<div class="weui-media-box__bd" ><img id="img_{{id}}" src="../img/wrong.png" class="right" style="display:none" />' +
                          '   <p class="weui-media-box__desc" answer="{{answer}}">{{no}}. {{question}}:</p>' +
                           '  <div class="weui-cells weui-cells_radio">' +
                            '     <label class="weui-cell weui-check__label" for="y{{id}}">' +
                             '        <div class="weui-cell__bd">' +
                              '           <p>A. 对</p>' +
                               '      </div>' +
                            '     <div class="weui-cell__ft">' +
         '                                <input type="radio" class="weui-check" name="radio_{{id}}" value="V"  id="y{{id}}">' +
          '                               <span class="weui-icon-checked"></span>' +
           '                          </div>' +
            '                     </label>' +
             '                    <label class="weui-cell weui-check__label" for="y2{{id}}">' +
        '                            <div class="weui-cell__bd">' +
         '                                <p>B. 错</p>' +
          '                           </div>' +
        '                          <div class="weui-cell__ft">' +
         '                                <input type="radio" name="radio_{{id}}" class="weui-check" value="X" id="y2{{id}}">' +
          '                               <span class="weui-icon-checked"></span>' +
           '                          </div>' +
            '                     </label>' +
             '                </div>' +
              '           </div>' +
               '      </span>' +
                ' </div>'

        var questions = [];

        $(function () {

            getUserInfo(url, setUserInfo);

            $("#judgeList").on("click", ".weui-cell.weui-check__label", function () {

                //alert($(this).html());
            })

            $("#btn-test").click(function () {

                for (var i = 0; i < questions.length; i++) {

                    console.log($("input[type=radio][name=radio_" + questions[i].eq_id + "]:checked").val());
                    var answer = $("input[type=radio][name=radio_" + questions[i].eq_id + "]:checked").val();
                    if (answer !== undefined) {
                        if (answer == questions[i].answer) {
                            $("img#img_" + questions[i].eq_id).attr("src", "../img/right.png").show();
                        } else {
                            $("img#img_" + questions[i].eq_id).attr("src", "../img/wrong.png").show();
                        }
                    }
                  
                }

             
            });


            $("#goToTest").on("click", function () {

                location.href = 'test.html?ep_id=22&user_id=' + userInfo.emplId;
            });

            var aqHtml = ' <div class="panel-body">' +
                            '<div class="card-alert">' +
                                '<div class="alert-body">' +
                                ' <div class="item">' +
                                ' <div class="user"><div><img src="{{cover}}" />&nbsp; {{name}}</div>   <span>{{time}}</span></div>' +
                                '  <p>{{conent}}</p>' +
                                ' </div>' +
                                '</div>' +
                            ' </div>' +
                          ' </div>';

            $.get("https://dangjain.ishoubei.com/article/" + id, function (rel) {
                articleTitle = rel.title;
                $("#title").html(rel.title);
                $("#period").html(rel.period);
                $("#author").html(rel.author);
                $("#pubtime").html(rel.pubtime);
                $("#source").html(rel.source);

                $("#encode-content").html(rel.content);
                $(".content").html($("#encode-content").text());



                $.get("https://dangjain.ishoubei.com/article/" + id + "/aq", function (rel) {

                    var html = [];

                    for (var i = 0; i < rel.aq.length; i++) {

                        html.push(
                         aqHtml.replace("{{time}}", rel.aq[i].created)
                               .replace("{{cover}}", rel.aq[i].cover)
                               .replace("{{name}}", rel.aq[i].author)
                               .replace("{{conent}}", rel.aq[i].content)
                             
                               );

                    }

                    $("#aqList").html(html.join(""));

                });


                $.get("https://dangjain.ishoubei.com/article/" + id + "/question", function (rel) {

                    questions = rel.rows;

                    var chosehtml = [];
                    var html = [];
                    var jcount = 0;
                    var cCount = 0;
                    for (var i = 0; i < rel.rows.length; i++) {

                        if (rel.rows[i].eqt_id == 1) {
                            html.push(
                         jHtml.replace("{{question}}", rel.rows[i].question)
                         .replace("{{no}}", ++jcount)
                         .myReplace("{{id}}", rel.rows[i].eq_id)
                           .replace("{{answer}}", rel.rows[i].answer)
                         );
                        } else {
                            chosehtml.push(
                                    cHtml.replace("{{question}}", rel.rows[i].question)
                                 .replace("{{answerA}}", rel.rows[i].op_a)
                                 .replace("{{answerB}}", rel.rows[i].op_b)
                                 .replace("{{answerC}}", rel.rows[i].op_c)
                                 .replace("{{answerD}}", rel.rows[i].op_d)
                                 .replace("{{no}}", ++cCount)
                                 .myReplace("{{id}}", rel.rows[i].eq_id)
                                 .replace("{{answer}}", rel.rows[i].answer)
                                    );
                        }


                    }
                    $("#choseList").html(chosehtml.join(""));
                    $("#judgeList").html(html.join(""));

                });

            });
        });

    </script>

</body>
</html>
